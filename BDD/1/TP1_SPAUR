CREATE TABLE PILOTE (
  PLNUM NUMBER,
  PLNOM VARCHAR(100),
  PLPRENOM VARCHAR(100),
  VILLE VARCHAR(100),
  SALAIRE NUMBER,
  PRIMARY KEY (PLNUM));
  
ALTER TABLE PILOTE 
  MODIFY (PLNOM VARCHAR(25), PLPRENOM VARCHAR(25), VILLE VARCHAR(25)); 

INSERT INTO PILOTE VALUES
  (1, 'MIRANDA', 'SERGE', 'PARIS', 2600);
INSERT INTO PILOTE VALUES
  (2, 'LETHANH', 'NAHN', 'TOULOUSE', 2100);
INSERT INTO PILOTE VALUES
  (3, 'TALADOIRE', 'GILLES', 'NICE', 1800);
INSERT INTO PILOTE VALUES
  (4, 'CHARBONNIER', 'ANNETTE', 'PARIS', 1700);
INSERT INTO PILOTE VALUES
  (5, 'REY', 'CHRISTOPHE', 'TOULOUSE', 1900);
INSERT INTO PILOTE VALUES
  (6, 'CHARBONNIER', 'FABIEN', 'PARIS', 1800);
INSERT INTO PILOTE VALUES
  (7, 'RENAULD', 'PIERRE', 'NICE', 1700);
INSERT INTO PILOTE VALUES
  (8, 'FOUILHOUX', 'PIERRE', 'LYON', 1500);
INSERT INTO PILOTE VALUES
  (9, 'GANNAT', 'CHRISTOPHE', NULL, 1800);
INSERT INTO PILOTE VALUES
  (10, 'GADAIX', 'SONIA', 'PARIS', 2000);
  
CREATE TABLE AVION (
  AVNUM NUMBER,
  AVNOM VARCHAR(25),
  CAPACITE NUMBER,
  LOCALISATION VARCHAR(25),
  PRIMARY KEY (AVNUM));

INSERT INTO AVION VALUES
  (1, 'A300', 300, 'NICE');
INSERT INTO AVION VALUES
  (2, 'A310', 300, 'NICE');
INSERT INTO AVION VALUES
  (3, 'B707', 250, 'PARIS');
INSERT INTO AVION VALUES
  (4, 'A300', 280, 'LYON');
INSERT INTO AVION VALUES
  (5, 'CONCORDE', 160, 'NICE');
INSERT INTO AVION VALUES
  (6, 'B747', 460, 'PARIS');
INSERT INTO AVION VALUES
  (7, 'B707', 250, 'PARIS');
INSERT INTO AVION VALUES
  (8, 'A310', 300, 'TOULOUSE');
INSERT INTO AVION VALUES
  (9, 'MERCURE', 180, 'LYON');
INSERT INTO AVION VALUES
  (10, 'CONCORDE', 160, 'PARIS');

CREATE TABLE VOL (
  VOLNUM NUMBER,
  PLNUM NUMBER,
  AVNUM NUMBER,
  VILLEDEP VARCHAR(25),
  VILLEARR VARCHAR(25),
  HEUREDEP NUMBER,
  HEUREARR NUMBER,
  PRIMARY KEY (VOLNUM),
  FOREIGN KEY (PLNUM) REFERENCES PILOTE(PLNUM),
  FOREIGN KEY (AVNUM) REFERENCES AVION(AVNUM));

INSERT INTO VOL VALUES
  (100, 1, 1, 'NICE', 'TOULOUSE', 1100, 1230);
INSERT INTO VOL VALUES
  (101, 1, 8, 'PARIS', 'TOULOUSE', 1700, 1830);
INSERT INTO VOL VALUES
  (102, 2, 1, 'TOULOUSE', 'LYON', 1400, 1600);
INSERT INTO VOL VALUES
  (103, 5, 3, 'TOULOUSE', 'LYON', 1800, 2000);
INSERT INTO VOL VALUES
  (104, 9, 1, 'PARIS', 'NICE', 0645, 0815);
INSERT INTO VOL VALUES
  (105, 10, 2, 'LYON', 'NICE', 1100, 1200);
INSERT INTO VOL VALUES
  (106, 1, 4, 'PARIS', 'LYON', 0800, 0900);
INSERT INTO VOL VALUES
  (107, 8, 4, 'NICE', 'PARIS', 0715, 0845);
INSERT INTO VOL VALUES
  (108, 1, 8, 'NANTES', 'LYON', 0900, 1530);
INSERT INTO VOL VALUES
  (109, 8, 2, 'NICE', 'PARIS', 1215, 1345);
INSERT INTO VOL VALUES
  (110, 9, 2, 'PARIS', 'LYON', 1500, 1600);
INSERT INTO VOL VALUES
  (111, 1, 2, 'LYON', 'NANTES', 1630, 2000);
INSERT INTO VOL VALUES
  (112, 4, 5, 'NICE', 'LENS', 1100, 1400);
INSERT INTO VOL VALUES
  (113, 3, 5, 'LENS', 'PARIS', 1500, 1600);
INSERT INTO VOL VALUES
  (114, 8, 9, 'PARIS', 'TOULOUSE', 1700, 1800);
INSERT INTO VOL VALUES
  (115, 7, 5, 'PARIS', 'TOULOUSE', 1800, 1900);

EXERCICE 5
1.
SELECT * FROM PILOTE;
2.
SELECT PLNOM, PLPRENOM FROM PILOTE;
3.
SELECT PLNUM, PLNOM FROM PILOTE;
4.
SELECT DISTINCT VILLEDEP FROM VOL;
5.
SELECT PLNOM FROM PILOTE WHERE VILLE = 'PARIS';
6.
SELECT PLNOM FROM PILOTE WHERE SALAIRE > 2500;
7.
SELECT PLNOM FROM PILOTE WHERE VILLE IS NULL;
8.
SELECT * FROM AVION WHERE AVNOM = 'A310' 
  OR AVNOM = 'A320'
  OR AVNOM = 'A330'
  OR AVNOM = 'A340';
9.
SELECT PLNOM FROM PILOTE 
  WHERE SALAIRE >= 2000
  OR SALAIRE <= 2500;
10.
SELECT CAPACITE FROM AVION
  WHERE AVNOM LIKE 'A%';
11.
SELECT AVNOM FROM AVION 
  WHERE AVNOM != 'A310' 
  AND AVNOM != 'A320'
  AND AVNOM != 'A330'
  AND AVNOM != 'A340';
12.
SELECT * FROM VOL 
  WHERE VILLEDEP = 'NICE'
  AND VILLEARR = 'PARIS';
13.

14.
SELECT AVG(SALAIRE) FROM PILOTE
  WHERE VILLE = 'PARIS';
15.
SELECT COUNT(*) FROM VOL
  WHERE VILLEDEP = 'PARIS';
16.
SELECT DISTINCT PLNOM FROM PILOTE, VOL, AVION
  WHERE PILOTE.PLNUM = VOL.PLNUM
  AND AVION.AVNUM = VOL.AVNUM
  AND VILLEDEP = 'PARIS'
  AND AVNOM LIKE 'A%';
17.
SELECT * FROM AVION
  WHERE LOCALISATION = (
    SELECT LOCALISATION FROM AVION 
      WHERE AVNUM = 3);
18.
SELECT * FROM PILOTE
  WHERE SALAIRE > (
    SELECT AVG(SALAIRE) FROM PILOTE);
19.
SELECT DISTINCT PLNOM FROM PILOTE, VOL
  WHERE PILOTE.PLNUM = VOL.PLNUM
  AND VILLEDEP = 'PARIS';
20.
SELECT PLNOM FROM PILOTE
  WHERE VILLE = 'NICE'
  AND SALAIRE > (SELECT MAX(SALAIRE) FROM PILOTE WHERE VILLE = 'PARIS');
21.
SELECT PLNOM FROM PILOTE
  WHERE VILLE = 'NICE'
  AND SALAIRE > (SELECT MIN(SALAIRE) FROM PILOTE WHERE VILLE = 'PARIS');
22.
SELECT PLNOM FROM PILOTE
  WHERE VILLE = (SELECT VILLE FROM PILOTE WHERE PLNOM = 'MIRANDA')
  AND SALAIRE = (SELECT SALAIRE FROM PILOTE WHERE PLNOM = 'MIRANDA');
23.
SELECT PLNOM FROM PILOTE
  WHERE VILLE = 'PARIS'
  ORDER BY SALAIRE DESC;
SELECT PLNOM FROM PILOTE
  WHERE VILLE = 'PARIS'
  ORDER BY PLNOM;
24.
SELECT PLNUM, COUNT(VOLNUM) FROM VOL
  GROUP BY VOL.PLNUM
  ORDER BY PLNUM;
25.
SELECT PLNUM, AVNUM, COUNT(VOLNUM) FROM VOL
  GROUP BY PLNUM, AVNUM
  ORDER BY PLNUM;
26.
SELECT PLNUM, COUNT(VOLNUM) FROM VOL
  GROUP BY VOL.PLNUM
  HAVING COUNT(VOLNUM) > 5
  ORDER BY PLNUM;
27.
SELECT VOL.PLNUM, PILOTE.PLNOM, COUNT(VOLNUM) FROM VOL, PILOTE
  WHERE VOL.PLNUM = PILOTE.PLNUM
  GROUP BY VOL.PLNUM, PILOTE.PLNOM
  HAVING COUNT(VOLNUM) > 5;
28.
SELECT AVNOM FROM AVION
  WHERE CAPACITE > 250
  OR LOCALISATION = 'PARIS';
29.
SELECT DISTINCT V1.PLNUM FROM VOL V1, VOL V2
  WHERE V1.PLNUM = V2.PLNUM
  AND V1.AVNUM = 2
  AND V2.AVNUM = 4;
30.
SELECT DISTINCT V1.PLNUM FROM VOL V1, VOL V2
  WHERE V1.PLNUM = V2.PLNUM
  AND (V1.AVNUM = 2
  OR V2.AVNUM = 4);
31.
SELECT V1.PLNUM FROM VOL V1
  WHERE V1.AVNUM = 2
  AND (SELECT COUNT(V2.VOLNUM) FROM VOL V2 
        WHERE V1.PLNUM = V2.PLNUM 
        AND V2.AVNUM = 4)
    = 0;
32.
SELECT V1.PLNUM FROM VOL V1
  WHERE (SELECT COUNT(AVNUM) FROM VOL V2 WHERE V1.PLNUM = V2.PLNUM)
    = (SELECT COUNT(AVNUM) FROM AVION);
33.
SELECT DISTINCT PLNUM FROM VOL, AVION
  WHERE VOL.AVNUM = AVION.AVNUM
  AND AVNOM = 'A310';
